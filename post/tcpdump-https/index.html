<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>tcpdump-https | Karthikeyan Sundararajan</title>
    
    
    
    <meta name="description" content="TCP Dump HTTPS">
    
    
    
    <meta property="og:title" content="tcpdump-https | Karthikeyan Sundararajan">
    <meta property="og:description" content="TCP Dump HTTPS">
    <meta property="og:type" content="article">
    <meta property="og:url" content="https://karthikeayan.github.io/post/tcpdump-https/">
    
    
    
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="tcpdump-https | Karthikeyan Sundararajan">
    <meta name="twitter:description" content="TCP Dump HTTPS">
    
    
    
    
    <link rel="icon" type="image/x-icon" href="/favicon.ico">
    
    
    
    <link rel="stylesheet" href="https://karthikeayan.github.io/css/main.min.f3239320356012e75e56b485acbe843df5e30ad1394d6abfc4a43aa4d51478f0.css">
    
    
    
    
    
</head>
<body>
    
    
    <div class="browser-chrome">
        <div class="toolbar">
            <span class="toolbar-button">Back</span>
            <span class="toolbar-button">Forward</span>
            <span class="toolbar-button">Refresh</span>
            <span class="toolbar-button">Home</span>
        </div>
        <div class="address-bar">
            
            https://karthikeayan.github.io/post/tcpdump-https/
            
        </div>
    </div>
    
    
    <div class="container">
        
        <nav class="site-nav">
    <ul class="nav-menu">

        
        
            
            <li class="nav-item">
                <a href="https://karthikeayan.github.io/" class="nav-link">
                    Home
                </a>
            </li>
            
            <li class="nav-item">
                <a href="https://karthikeayan.github.io/posts/" class="nav-link">
                    Posts
                </a>
            </li>
            
            <li class="nav-item">
                <a href="https://karthikeayan.github.io/about/" class="nav-link">
                    About
                </a>
            </li>
            

            
            
            
            <li class="nav-item">
                <a href="https://karthikeayan.github.io/categories/" class="nav-link">üìÇ Categories</a>
            </li>
            

            
            
            <li class="nav-item">
                <a href="https://karthikeayan.github.io/tags/" class="nav-link">üè∑Ô∏è Tags</a>
            </li>
            

        

        
        
        <li class="nav-item">
            <a href="https://karthikeayan.github.io/index.xml" class="nav-link">üì° RSS</a>
        </li>
        
    </ul>
</nav>

        
        
        <header class="site-header">
            <div class="window">
                <div class="window-header">
                    <span class="window-title">Karthikeyan Sundararajan</span>
                    <div class="window-controls">
                        <span class="window-button">_</span>
                        <span class="window-button">‚ñ°</span>
                        <span class="window-button">√ó</span>
                    </div>
                </div>
                <div class="window-content">
                    <a href="https://karthikeayan.github.io/" class="site-title">Karthikeyan Sundararajan</a>
                    
                </div>
            </div>
        </header>
        
        
        <main class="main-content">
            
<article class="window">
    <div class="window-header">
        <span class="window-title">tcpdump-https</span>
        <div class="window-controls">
            <span class="window-button">_</span>
            <span class="window-button">‚ñ°</span>
            <span class="window-button">√ó</span>
        </div>
    </div>
    <div class="window-content">
        <header class="content-header">
            <h1 class="post-title">tcpdump-https</h1>
            
            
            <div class="post-meta">
                <span class="post-meta-item">
                    üìÖ Published: Sunday, May 21, 2023
                </span>
                
                <span class="post-meta-item">
                    üìñ 2 min read
                </span>
                <span class="post-meta-item">
                    üìä 421 words
                </span>
                
                
                
                
                
                
                <span class="post-meta-item">
                    üè∑Ô∏è Tags: 
                    
                        
                        <a href="/tags/tcpdump">tcpdump</a>
                    
                        , 
                        <a href="/tags/https">https</a>
                    
                        , 
                        <a href="/tags/network">network</a>
                    
                        , 
                        <a href="/tags/packet">packet</a>
                    
                        , 
                        <a href="/tags/kubernetes">kubernetes</a>
                    
                        , 
                        <a href="/tags/observability">observability</a>
                    
                </span>
                
                
                
            </div>
            
            
            
            <div class="post-description" style="font-style: italic; margin: 8px 0; padding: 4px 8px; background: var(--bg-secondary); border: 1px inset var(--border-dark);">
                TCP Dump HTTPS
            </div>
            
            
            
        </header>
        
        
        
        
        
        <div class="content">
            <h1 id="how-to-capture-https-outbound-requestresponse-headers">How to capture HTTPS outbound request/response headers?</h1>
<p>What to do when you get unexpected HTTPS Response code from your application or any third party application which you are using that connects to Rest endpoint? Especially when we don&rsquo;t have access to the target Rest endpoint?
When we seek for help, everyone will suggest to see the response headers of the HTTPS request.
But how can we see the response header? There are couple of ways:</p>
<ul>
<li>Log HTTPS request/response header in your application - Quicker solution</li>
<li>Use any monitoring tools that provides this feature, could be costly</li>
<li>Look for any tool. Simple Google search will suggest to use Fiddler but from my quick look that is for local developement debugging.</li>
<li>Look for any other tool. HTTPToolKit looks promising but as of writing this article, it doesn&rsquo;t have headless feature. So, running this in your infra may be challenging. Especially in Kubernetes.</li>
<li>Stick with old school approach, tcpdump.</li>
</ul>
<h2 id="tcp-dump">TCP Dump</h2>
<p>Simple isn&rsquo;t it?</p>
<ul>
<li>Just take tcp dump by logging into the target pod/server</li>
<li>Install tcpdump (better copy the binary)</li>
<li>Take dump and copy it to your local</li>
<li>Load it to Wireshark</li>
</ul>
<p>Done, isn&rsquo;t it?</p>
<p>But you don&rsquo;t see any HTTPS traffic in the Wireshark UI. What are we missing?</p>
<p>Since HTTPS requests are HTTP over TLS. All the HTTPS requests are encrypted. We need the secrets to decrypt the data.</p>
<h2 id="what-is-sslkeylogfile">What is SSLKEYLOGFILE?</h2>
<p>It is an environment variable which is understood by most common used applications.</p>
<h3 id="does-curl-supports-it">Does Curl supports it?</h3>
<p>Yes, but only the Curl with SSL support. (Build curl with SSL support - <a href="https://stackoverflow.com/questions/28782556/how-do-i-get-curl-to-use-https">https://stackoverflow.com/questions/28782556/how-do-i-get-curl-to-use-https</a>)
Just set the value of SSLKEYLOGFILE to the file path in the shell.</p>
<pre tabindex="0"><code>$ export SSLKEYLOGFILE=/tmp/sslkeylogfile.log

# Start tcpdump in another shell

$ curl https://google.com
&lt;HTML&gt;&lt;HEAD&gt;&lt;meta http-equiv=&#34;content-type&#34; content=&#34;text/html;charset=utf-8&#34;&gt;
&lt;TITLE&gt;301 Moved&lt;/TITLE&gt;&lt;/HEAD&gt;&lt;BODY&gt;
&lt;H1&gt;301 Moved&lt;/H1&gt;
The document has moved
&lt;A HREF=&#34;https://www.google.com/&#34;&gt;here&lt;/A&gt;.
&lt;/BODY&gt;&lt;/HTML&gt;

$ cat /tmp/SSLKEYLOGFILE
CLIENT_RANDOM C76EE3XXXXX FB0CE69XXXXX
</code></pre><h3 id="does-browsers-supports-it">Does browsers supports it?</h3>
<p>Yes, Just set the value of SSLKEYLOGFILE to the file path in the shell and open browser from the shell.</p>
<pre tabindex="0"><code>$ export SSLKEYLOGFILE=/tmp/sslkeylogfile.log

# Start tcpdump in another shell

$ /Applications/Google\ Chrome.app/Contents/MacOS/Google\ Chrome

$ cat /tmp/SSLKEYLOGFILE
CLIENT_RANDOM C76EE3XXXXX FB0CE69XXXXX
</code></pre><h2 id="tell-wireshark-to-use-the-sslkeylogfile">Tell Wireshark to use the SSLKEYLOGFILE</h2>
<p>Go to</p>
<ul>
<li>Wireshark Preferences</li>
<li>Protocols &ndash;&gt; TLS</li>
<li>(Pre)-Master-Secret log filename &ndash;&gt; Select /tmp/sslkeylogfile.log</li>
<li>Open dump file</li>
<li>Thats it, you can see the HTTPS requests</li>
</ul>
<h2 id="but-what-about-java-applications">But what about JAVA applications?</h2>
<p>Make use of Java Agents.</p>
<ul>
<li>Download this Jar file, <a href="https://github.com/neykov/extract-tls-secrets">https://github.com/neykov/extract-tls-secrets</a></li>
<li>Attach it to yoru Java application</li>
</ul>
<pre tabindex="0"><code>java -javaagent:~/Downloads/extract-tls-secrets-4.0.0.jar=/tmp/sslkeylogfile.log -jar MyApp.jar
</code></pre><ul>
<li>In Kubernetes, we can make use of JAVA_TOOL_OPTIONS environment varilable.</li>
</ul>
<pre tabindex="0"><code>env:
  name: JAVA_TOOL_OPTIONS
  value: -javaagent:~/Downloads/extract-tls-secrets-4.0.0.jar=/tmp/sslkeylogfile.log
</code></pre>
        </div>
        
        
        <footer class="post-footer" style="margin-top: 20px; padding-top: 12px; border-top: 1px solid var(--border-dark);">
            
            
            
            <div class="sharing" style="margin-bottom: 12px;">
                <div style="font-weight: bold; margin-bottom: 6px;">üì§ Share this post:</div>
                <div style="display: flex; gap: 4px; flex-wrap: wrap;">
                    <a href="https://twitter.com/intent/tweet?text=tcpdump-https&url=https%3a%2f%2fkarthikeayan.github.io%2fpost%2ftcpdump-https%2f" 
                       target="_blank" class="btn" style="font-size: 10px;">Twitter</a>
                    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2fkarthikeayan.github.io%2fpost%2ftcpdump-https%2f" 
                       target="_blank" class="btn" style="font-size: 10px;">Facebook</a>
                    <a href="https://www.linkedin.com/sharing/share-offsite/?url=https%3a%2f%2fkarthikeayan.github.io%2fpost%2ftcpdump-https%2f" 
                       target="_blank" class="btn" style="font-size: 10px;">LinkedIn</a>
                    <a href="mailto:?subject=tcpdump-https&body=https%3a%2f%2fkarthikeayan.github.io%2fpost%2ftcpdump-https%2f" 
                       class="btn" style="font-size: 10px;">Email</a>
                </div>
            </div>
            
            
            
            
            
            
            
            
            <div class="related-posts" style="background: var(--bg-secondary); border: 1px inset var(--border-dark); padding: 8px; margin: 12px 0;">
                <div style="font-weight: bold; margin-bottom: 6px;">üîó Related Posts:</div>
                <ul style="padding-left: 1rem; margin: 0; font-size: 10px;">
                    
                    <li style="margin: 2px 0;">
                        <a href="https://karthikeayan.github.io/post/kubernetes-playground-in-seconds/">kubernetes-playground-in-seconds</a>
                        <span style="color: var(--text-secondary);"> - Feb 12</span>
                    </li>
                    
                </ul>
            </div>
            
            
            
            
        </footer>
    </div>
</article>


<nav class="post-nav" style="display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin: 8px 0;">
    
    <div class="window">
        <div class="window-header">
            <span class="window-title">‚Üê Previous Post</span>
            <div class="window-controls">
                <span class="window-button">_</span>
                <span class="window-button">‚ñ°</span>
                <span class="window-button">√ó</span>
            </div>
        </div>
        <div class="window-content">
            <a href="https://karthikeayan.github.io/post/good-blogs/" style="text-decoration: none; color: inherit;">
                <div style="font-weight: bold; font-size: 10px; margin-bottom: 2px;">good-blogs</div>
                <div style="font-size: 9px; color: var(--text-secondary);">Feb 13, 2022</div>
            </a>
        </div>
    </div>
    
    
    
    <div class="window">
        <div class="window-header">
            <span class="window-title">Next Post ‚Üí</span>
            <div class="window-controls">
                <span class="window-button">_</span>
                <span class="window-button">‚ñ°</span>
                <span class="window-button">√ó</span>
            </div>
        </div>
        <div class="window-content">
            <a href="https://karthikeayan.github.io/post/kubernetes-api-resources/" style="text-decoration: none; color: inherit;">
                <div style="font-weight: bold; font-size: 10px; margin-bottom: 2px;">kubernetes-api-resources</div>
                <div style="font-size: 9px; color: var(--text-secondary);">Jul 21, 2023</div>
            </a>
        </div>
    </div>
    
</nav>




        </main>
        
        
        
        <aside class="sidebar">
            








<div class="sidebar-section">
    <div class="sidebar-title">üè∑Ô∏è Popular Tags</div>
    <div class="tag-cloud">
        
        <a href="/tags/kubernetes">
            kubernetes (5)
        </a>
        
        <a href="/tags/aws">
            aws (3)
        </a>
        
        <a href="/tags/cli">
            cli (2)
        </a>
        
        <a href="/tags/ad">
            ad (1)
        </a>
        
        <a href="/tags/ai">
            ai (1)
        </a>
        
        <a href="/tags/alternate">
            alternate (1)
        </a>
        
        <a href="/tags/api-resources">
            api-resources (1)
        </a>
        
        <a href="/tags/aws-cur">
            aws-cur (1)
        </a>
        
        <a href="/tags/azure">
            azure (1)
        </a>
        
        <a href="/tags/bash">
            bash (1)
        </a>
        
        <a href="/tags/blogs">
            blogs (1)
        </a>
        
        <a href="/tags/budget">
            budget (1)
        </a>
        
        <a href="/tags/cheatsheet">
            cheatsheet (1)
        </a>
        
        <a href="/tags/cost">
            cost (1)
        </a>
        
        <a href="/tags/csv">
            csv (1)
        </a>
        
    </div>
</div>




<div class="sidebar-section">
    <div class="sidebar-title">üìÖ Archives</div>
    <ul>
        
        <li>
            <a href="/posts/2025-05/">
                2025-05 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/2025-03/">
                2025-03 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/2023-07/">
                2023-07 (2)
            </a>
        </li>
        
        <li>
            <a href="/posts/2023-05/">
                2023-05 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/2022-02/">
                2022-02 (2)
            </a>
        </li>
        
        <li>
            <a href="/posts/2021-12/">
                2021-12 (2)
            </a>
        </li>
        
        <li>
            <a href="/posts/2021-11/">
                2021-11 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/2021-10/">
                2021-10 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/2021-05/">
                2021-05 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/2021-01/">
                2021-01 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/2020-06/">
                2020-06 (1)
            </a>
        </li>
        
        <li>
            <a href="/posts/0001-01/">
                0001-01 (1)
            </a>
        </li>
        
    </ul>
</div>







<div class="sidebar-section">
    <div class="sidebar-title">üåê Connect</div>
    <ul>
        
        <li><a href="https://twitter.com/karthikeayan" target="_blank">üê¶ Twitter</a></li>
        
        
        <li><a href="https://github.com/https://github.com/karthikeayan" target="_blank">üê± GitHub</a></li>
        
        
        <li><a href="https://linkedin.com/in/https://www.linkedin.com/in/karthikeyan-sundararajan/" target="_blank">üíº LinkedIn</a></li>
        
        
        <li><a href="mailto:karthikeayan@live.com">üìß Email</a></li>
        
        
        
        
    </ul>
</div>




<div class="sidebar-section">
    <div class="sidebar-title">‚ÑπÔ∏è Info</div>
    <div style="font-size: 10px; line-height: 1.3;">
        Welcome to our retro corner of the internet!
    </div>
</div>




<div class="sidebar-section">
    <div class="sidebar-title">üìä Site Stats</div>
    <div style="font-size: 10px;">
        <div>Total Posts: 0</div>
        <div>Total Pages: 15</div>
        <div>Categories: 0</div>
        <div>Tags: 61</div>
        <div>Last Updated: May 16, 2025</div>
    </div>
</div>




<div class="sidebar-section">
    <div class="sidebar-title">‚ú® Retro Corner</div>
    <div style="text-align: center; font-size: 9px;">
        <div style="background: #000; color: #00ff00; padding: 2px; font-family: 'Courier New', monospace; margin: 4px 0;">
            > SYSTEM ONLINE
        </div>
        <div class="blink" style="color: var(--text-link);">
            üåü NEW! üåü
        </div>
        <div style="margin: 4px 0;">
            Best viewed in 1024x768
        </div>
        <div>
            Powered by Hugo 0.123.7
        </div>
    </div>
</div>


        </aside>
        
        
        
        <footer class="site-footer">
    <div class="window">
        <div class="window-header">
            <span class="window-title">üíª Site Information</span>
            <div class="window-controls">
                <span class="window-button">_</span>
                <span class="window-button">‚ñ°</span>
                <span class="window-button">√ó</span>
            </div>
        </div>
        <div class="window-content">
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 12px; font-size: 10px;">
                
                
                <div>
                    <div style="font-weight: bold; margin-bottom: 4px;">üìã Site Info</div>
                    <div>¬© 2025 Karthikeyan Sundararajan</div>
                    
                    <div>Created by Karthikeyan Sundara Rajan</div>
                    
                    <div>Powered by <a href="https://gohugo.io" target="_blank">Hugo</a></div>
                    <div>Theme: <a href="https://github.com/vibecodemama/vintage-web-hugo-theme" target="_blank">Vintage Web</a></div>
                </div>
                
                
                <div>
                    <div style="font-weight: bold; margin-bottom: 4px;">üîó Quick Links</div>
                    <div><a href="https://karthikeayan.github.io/">üè† Home</a></div>
                    
                    
                    <div><a href="/categories/">üìÇ Categories</a></div>
                    <div><a href="/tags/">üè∑Ô∏è Tags</a></div>
                    
                    <div><a href="/index.xml">üì° RSS Feed</a></div>
                    
                </div>
                
                
                
                <div>
                    <div style="font-weight: bold; margin-bottom: 4px;">üåê Connect</div>
                    
                    <div><a href="mailto:karthikeayan@live.com">üìß Email</a></div>
                    
                    
                    <div><a href="https://twitter.com/karthikeayan" target="_blank">üê¶ Twitter</a></div>
                    
                    
                    <div><a href="https://github.com/https://github.com/karthikeayan" target="_blank">üê± GitHub</a></div>
                    
                    
                    <div><a href="https://linkedin.com/in/https://www.linkedin.com/in/karthikeyan-sundararajan/" target="_blank">üíº LinkedIn</a></div>
                    
                </div>
                
                
                
                <div>
                    <div style="font-weight: bold; margin-bottom: 4px;">üìä Statistics</div>
                    <div>Posts: 0</div>
                    <div>Categories: 0</div>
                    <div>Tags: 61</div>
                    <div>Last Update: May 16, 2025</div>
                </div>
            </div>
            
            
            
            <div style="margin-top: 12px; padding-top: 8px; border-top: 1px solid var(--border-dark); text-align: center;">
                <div style="font-size: 9px; margin-bottom: 4px;">
                    <span class="blink">‚≠ê</span> 
                    This site is Y2K compliant! 
                    <span class="blink">‚≠ê</span>
                </div>
                <div style="font-size: 8px; color: var(--text-secondary);">
                    Best viewed in Any modern browser
                    ‚Ä¢ Screen resolution: 1024x768 or higher
                </div>
                <div style="font-size: 8px; margin-top: 4px;">
                    Visitor counter: 
                    <span style="background: #000; color: #00ff00; padding: 1px 3px; font-family: 'Courier New', monospace;">
                        999999
                    </span>
                </div>
            </div>
            
            
            
            
            
            
            
        </div>
    </div>
</footer>

    </div>
    
    
    
    <div class="status-bar">
        <div class="status-left">
            <span class="status-item">Sat 26 Jul 2025</span>
            <span class="status-item">16:51</span>
        </div>
        <div class="status-right">
            <span class="status-item">Karthikeyan Sundararajan</span>
            
            <span class="status-item">421 words</span>
            
        </div>
    </div>
    
    
    
    
    
    
    <script src="https://karthikeayan.github.io/js/main.min.31530ca7626eaa26864855cd725b9ff139b89f64769abfe234c890102381f252.js"></script>
    
    
    
    
    
    
    
    
    
</body>
</html>
